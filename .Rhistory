anova(model)
plot(residuals(model) ~ fitted(model))
install.packages("car")
# Chunk 1: setup
knitr::opts_chunk$set(echo = FALSE)
# Chunk 2
library(aomisc)
data(NWheat)
NWheat
# Chunk 3
model <- lm(Yield ~ factor(Block) + factor(Dose), data=NWheat)
anova(model)
qqplot(residuals(model))
qqnorm(residuals(model) )
abline(b=1)
?abline
abline(a=0,b=1)
plot(model)
qqnorm(residuals(model))
abline(a=0,b=1)
plot(model)
qqnorm(residuals(model)/1.15)
abline(a=0,b=1)
qqnorm(residuals(model)/(1.15*2))
abline(a=0,b=1)
par(mfrow=c(1,2))
plot(model)
par(mfrow=c(2,2))
plot(model)
setwd("~/Documents/_DBXAndrea/Dropbox/_Lavoro/__Notes/__Stats/40 - LinearModels/_LinearRegressionModels/_ParametrizzazioneModelliLinear/Nwheat")
modelReg <- lm(Yield ~ Dose, data=NWheat)
summary(model)
summary(modelReg)
modelReg <- lm(Yield ~ Dose, data=NWheat)
summary(modelReg)
plot(residuals(modelReg) ~ fitted(modelReg))
anova(modelReg)
# Chunk 1: setup
knitr::opts_chunk$set(echo = FALSE)
# Chunk 2
library(aomisc)
data(NWheat)
NWheat
# Chunk 3
model <- lm(Yield ~ factor(Block) + factor(Dose), data=NWheat)
anova(model)
# Chunk 4
par(mfrow=c(2,2))
plot(model)
plot(residuals(model) ~ fitted(model))
qqnorm(residuals(model)/(1.15*2))
abline(a=0,b=1)
# Chunk 5
modelReg <- lm(Yield ~ Dose, data=NWheat)
summary(modelReg)
anova(modelReg)
modelReg <- lm(Yield ~ Dose, data=NWheat)
summary(modelReg)
modelReg <- lm(Yield ~ factor(Blocco) + Dose, data=NWheat)
modelReg <- lm(Yield ~ factor(Block) + Dose, data=NWheat)
summary(modelReg)
coef(modelReg)[1:4]
sum(coef(modelReg)[1:4])
library(emmeans)
emmeans(modelReg, ~Block)
emmeans(modelReg, ~1)
emmeans(modelReg, ~factor(Block))
options(contrasts=c("contr.sum", "contr.poly"))
modelReg <- lm(Yield ~ factor(Block) + Dose, data=NWheat)
summary(modelReg)
modelReg <- lm(Yield ~ Dose, data=NWheat)
summary(modelReg)
library(aomisc)
library(aomisc)
data(NWheat)
NWheat
model <- lm(Yield ~ factor(Dose), data=NWheat)
anova(model)
par(mfrow=c(2,2))
plot(model)
library(aomisc)
devtools::install_github("OnofriAndeaPG/aomisc")
devtools::install_github("OnofriAndeaPG/aomisc")
devtools::install_github("OnofriAndeaPG/aomisc")
devtools::install_github("/OnofriAndeaPG/aomisc")
devtools::install_github("OnofriAndeaPG/aomisc/")
devtools::install_github("OnofriAndeaPG/aomisc")
devtools::install_github("OnofriAndeaPG/aomisc")
devtools::install_github("OnofriAndeaPG/statBook")
library(devtools)
install_github("OnofriAndreaPG/statBook")
libray(devtools)
install_github("OnofriAndeaPG/statBook")
install_github("OnofriAndreaPG/statBook")
install_github("OnofriAndeaPG/statBook")
devtools::install_github("OnofriAndreaPG/aomisc")
library(aomisc)
devtools::install_github("OnofriAndreaPG/aomisc")
library(aomisc)
data(phen)
library(aomisc)
data(phen)
data(Phen)
Phen
par(mfrow=c(2,2))
plot(model)
head(Phen)
model <- lm(Conc ~ Tempo*Tesi, data=CO2)
model <- lm(Conc ~ Tempo*Tesi, data=Phen)
anova(model)
model <- lm(Conc ~ factor(Tempo)*Tesi, data=Phen)
anova(model)
par(mfrow=c(2,2))
plot(model)
# Chunk 1
#Put at the beginning
knitr::knit_hooks$set(document = function(x){
gsub("```\n*```r*\n*", "", x)
})
# Chunk 2
Dose <- rep(c(0, 60, 120, 180), each=4)
Yield_E <- 25 + 0.15 * Dose
epsilon <- rnorm(16, 0, 2.5)
Yield <- Yield_E + epsilon
# Chunk 3
model <- lm(Yield ~ factor(Dose))
anova(model)
# Chunk 4
par(mfrow=c(2,2))
plot(model)
# Chunk 5
bartlett.test(Yield ~ factor(Dose))
car::leveneTest(Yield ~ factor(Dose))
shapiro.test(residuals(model))
# Chunk 6
modelReg <- lm(Yield ~ Dose)
summary(modelReg)
plot(Yield ~ Dose)
plot(Yield ~ Dose)
abline(modelReg, lty=2)
anova(modelReg, model)
2.6819/2
2.6819/2/(49.342/12)
plot(Yield ~ Dose)
abline(modelReg, lty=2)
pred <- predict(modelReg, newdata=data.frame(Dose=80), se=T)
pred
arrow(80, 0, 80, pred$fit)
arrows(80, 0, 80, pred$fit)
arrows(80, pred$fit, 0, pred$fit)
arrows(80, 0, 80, pred$fit, col="red")
arrows(80, pred$fit, 0, pred$fit, col="red")
plot(Yield ~ Dose)
abline(modelReg, lty=2)
arrows(80, 0, 80, pred$fit, col="red")
arrows(80, pred$fit, 0, pred$fit, col="red")
plot(Yield ~ Dose)
abline(modelReg, lty=2)
?deltaMethod
car::deltaMethod(modelReg, "(45 - b0)/b1", parameterNames=c("b0", "b1"))
plot(Yield ~ Dose)
abline(modelReg, lty=2)
arrows(0, 45, 143.7, 45, col="red")
arrows(143.7, 45, 143.7, 0, col="red")
arrows(143.7, 45, 143.7, 25, col="red")
par(mfrow=c(1,2))
plot(Yield ~ Dose)
abline(modelReg, lty=2)
arrows(80, 0, 80, pred$fit, col="red")
arrows(80, pred$fit, 0, pred$fit, col="red")
plot(Yield ~ Dose)
abline(modelReg, lty=2)
arrows(0, 45, 143.7, 45, col="red")
arrows(143.7, 45, 143.7, 25, col="red")
# Chunk 1
#Put at the beginning
knitr::knit_hooks$set(document = function(x){
gsub("```\n*```r*\n*", "", x)
})
# Chunk 2
set.seed(1234)
Dose <- rep(c(0, 60, 120, 180), each=4)
Yield_E <- 25 + 0.15 * Dose
epsilon <- rnorm(16, 0, 2.5)
Yield <- Yield_E + epsilon
model <- lm(Yield ~ factor(Dose))
anova(model)
sqrt(5.10/4)
anova(modelReg)
anova(model)
# Chunk 1
#Put at the beginning
knitr::knit_hooks$set(document = function(x){
gsub("```\n*```r*\n*", "", x)
})
# Chunk 2
set.seed(1234)
Dose <- rep(c(0, 60, 120, 180), each=4)
Yield_E <- 25 + 0.15 * Dose
epsilon <- rnorm(16, 0, 2.5)
Yield <- Yield_E + epsilon
# Chunk 3
model <- lm(Yield ~ factor(Dose))
anova(model)
# Chunk 4
par(mfrow=c(2,2))
plot(model)
# Chunk 5
bartlett.test(Yield ~ factor(Dose))
car::leveneTest(Yield ~ factor(Dose))
shapiro.test(residuals(model))
# Chunk 6
modelReg <- lm(Yield ~ Dose)
summary(modelReg)
# Chunk 7
plot(Yield ~ Dose)
abline(modelReg, lty=2)
anova(modelReg)
anova(model)
anova(modelReg, model)
F <- anova(modelReg)[1,3]/anova(model)[2,3]
df(F, 1, 12)
model.6 <- lm(Peso ~ Conc / Specie, data=CO2)
F <- anova(modelReg)[1,3]/anova(model)[2,3]
df(F, 1, 12)
var(Yield)*15
anova(modelReg)
1716.83/1787.21
pred <- predict(modelReg, newdata=data.frame(Dose=80), se=T)
pred
car::deltaMethod(modelReg, "(45 - b0)/b1", parameterNames=c("b0", "b1"))
hip <- function(x, i, a, P) P * (1 - i*x/(1+i*x/a))
curve(hip(x,0.2, 0.8, 30), from=0, to=10,
xlab="Densità malerbe", ylab="Produzione")
curve(30-3.7*x, add=T, from=0, to=3, col="red")
hip <- function(x, i, a, P) P * (1 - i*x/(1+i*x/a))
curve(hip(x,0.2, 0.8, 30), from=0, to=10,
xlab="Densità malerbe", ylab="Produzione")
curve(30-3.7*x, add=T, from=0, to=3, col="red")
library(aomisc)
data(sinapis)
sinapis
plot(yield ~ density, data=sinapis)
medie <- as.data.frame(emmeans::emmeans(mod, ~density,
data=sinapis))
plot(emmean ~ density, data=medie, ylim=c(25,39),
xlab="Densità (piante per mq)",
ylab="Produzione girasole (q/ha)")
medie <- as.data.frame(emmeans::emmeans(mod, ~density,
data=sinapis))
medie <- ddply(sinapis, c("density"),
function(df) c(Mean=mean(df$Weight)))
medie <- plyr::ddply(sinapis, c("density"),
function(df) c(Mean=mean(df$Weight)))
medie <- plyr::ddply(sinapis, c("density"),
function(df) c(Mean=mean(df$Weight)))
medie <- plyr::ddply(sinapis, c("density"),
function(df) c(Mean=mean(df$yield)))
medie
plot(Mean ~ density, data=medie, ylim=c(25,39),
xlab="Densità (piante per mq)",
ylab="Produzione girasole (q/ha)")
plot(Mean ~ density, data=medie, ylim=c(25,39),
xlab="Densità (piante per mq)",
ylab="Produzione girasole (q/ha)", type="b",
pch=21, bg="black")
points(yield ~ density, data=sinapis)
anova(modelReg)
rm(list=ls())
# Chunk 1: setup
#Put at the beginning
knitr::knit_hooks$set(document = function(x){
gsub("```\n*```r*\n*", "", x)
})
# Chunk 2
hip <- function(x, i, a, P) P * (1 - i*x/(1+i*x/a))
curve(hip(x,0.2, 0.8, 30), from=0, to=10,
xlab="Densità malerbe", ylab="Produzione")
curve(30-3.7*x, add=T, from=0, to=3, col="red")
# Chunk 3
library(aomisc)
data(sinapis)
sinapis
# Chunk 4
medie <- plyr::ddply(sinapis, c("density"),
function(df) c(Mean=mean(df$yield)))
plot(Mean ~ density, data=medie, ylim=c(25,39),
xlab="Densità (piante per mq)",
ylab="Produzione girasole (q/ha)", type="b",
pch=21, bg="black")
points(yield ~ density, data=sinapis)
# Chunk 5
mod <- lm(yield ~ factor(density), data=sinapis)
anova(mod)
# Chunk 6
modReg <- lm(yield ~ density, data=sinapis)
summary(modReg)
# Chunk 7
par(mfrow=c(1,2))
medie <- as.data.frame(emmeans::emmeans(mod, ~density,
data=sinapis))
plot(emmean ~ density, data=medie, ylim=c(25,39),
xlab="Densità (piante per mq)",
ylab="Produzione girasole (q/ha)")
abline(modReg)
plot(modReg$residuals ~ modReg$fitted, xlab="Attesi",
ylab="Residui", ylim=c(-2,2))
abline(h=0, lty=2)
# Chunk 8
anova(modReg, mod)
# Chunk 9
modReg2 <- lm(yield ~ density + I(density^2), data=sinapis)
summary(modReg2)
anova(modReg)
anova(modReg2)
anova(modReg2, modReg)
anova(modReg, modReg2)
library(aomisc)
data(Phen)
head(Phen)
model <- lm(Conc ~ factor(Tempo)*Tesi, data=Phen)
anova(model)
model <- lm(log(Conc) ~ factor(Tempo)*Tesi, data=Phen)
anova(model)
par(mfrow=c(2,2))
plot(model)
par(mfrow=c(2,2))
plot(model)
bartlett.test(log(Peso) ~ I(Specie:factor(Conc)), data=CO2)
bartlett.test(log(Conc) ~ I(Tesi:factor(Tempo)), data=Phen)
car::leveneTest(log(Conc) ~ I(Tesi:factor(Tempo)), data=Phen)
shapiro.test(residuals(model))
model.1 <- lm(Conc ~ Tesi  / Tempo - 1, data=Phen)
summary(model.1)
Medie <- plyr::ddply(Phen, c("Tesi", "Tempo"),
function(df) c(Mean=mean(df$Conc)))
Medie <- plyr::ddply(Phen, c("Tesi", "Tempo"),
function(df) c(Mean=mean(df$Conc)))
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="P"))
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="PC"), pch=2)
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="P"))
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="PC"), pch=2)
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="P"), ylim=c(0,100))
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="PC"), pch=2)
model.1 <- lm(log(Conc) ~ Tesi  / Tempo - 1, data=Phen)
summary(model.1)
Medie <- plyr::ddply(Phen, c("Tesi", "Tempo"),
function(df) c(Mean=mean(df$log(Conc))))
Phen$logConc <- log(Phen$Conc)
Medie <- plyr::ddply(Phen, c("Tesi", "Tempo"),
function(df) c(Mean=mean(df$log(Conc))))
Medie <- plyr::ddply(Phen, c("Tesi", "Tempo"),
function(df) c(Mean=mean(df$logConc)))
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="P"), ylim=c(0,100))
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="P"), ylim=c(0,5))
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="PC"), pch=2)
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="PC"), pch=2)
points(Medie$Mean ~ Medie$Conc, subset=c(Medie$Specie=="PM"), pch=3)
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="P"), ylim=c(0,5))
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="PC"), pch=2)
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="PM"), pch=3)
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="PCM"), pch=4)
setwd("~/Documents/_DBXAndrea/Dropbox/_Lavoro/__Notes/__Stats/40 - LinearModels/ANCOVA_Models")
matamitron <- read.csv("metamitron.csv", header=T)
save(metamitron, file="metamitron.rda")
metamitron <- read.csv("metamitron.csv", header=T)
save(metamitron, file="metamitron.rda")
devtools::install_github("OnofriAndreaPG/aomisc")
library(aomisc)
data(metamitron)
head(metamitron)
metamitron <- read.csv("metamitron.csv", header=T)
head(metamitron)
metamitron <- read.csv("metamitron.csv", header=T)
head(metamitron)
save(metamitron, file="metamitron.rda")
devtools::install_github("OnofriAndreaPG/aomisc")
library(aomisc)
data(Phen)
data(metamitron)
head(metamitron)
model <- lm(log(Conc) ~ factor(Tempo)*Tesi, data=metamitron)
anova(model)
par(mfrow=c(2,2))
plot(model)
bartlett.test(log(Conc) ~ I(Tesi:factor(Tempo)), data=Phen)
car::leveneTest(log(Conc) ~ I(Tesi:factor(Tempo)), data=Phen)
shapiro.test(residuals(model))
rm(list=ls())
data(metamitron)
head(metamitron)
model <- lm(log(Conc) ~ factor(Tempo)*Tesi, data=metamitron)
anova(model)
par(mfrow=c(2,2))
plot(model)
bartlett.test(log(Conc) ~ I(Tesi:factor(Tempo)), data=Phen)
bartlett.test(log(Conc) ~ I(Tesi:factor(Tempo)), data=metamitron)
car::leveneTest(log(Conc) ~ I(Tesi:factor(Tempo)), data=metamitron)
shapiro.test(residuals(model))
model.1 <- lm(log(Conc) ~ Tesi  / Tempo - 1, data=metamitron)
summary(model.1)
metamitron$logConc <- log(metamitron$Conc)
Medie <- plyr::ddply(metamitron, c("Tesi", "Tempo"),
function(df) c(Mean=mean(df$logConc)))
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="P"), ylim=c(0,5))
Medie <- plyr::ddply(metamitron, c("Tesi", "Tempo"),
function(df) c(Mean=mean(df$logConc)))
Medie
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="M"), ylim=c(0,5))
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="M"), ylim=c(0,5))
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MC"), pch=2)
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MP"), pch=3)
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MPC"), pch=4)
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="M"), ylim=c(2,5))
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MC"), pch=2)
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MP"), pch=3)
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MPC"), pch=4)
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="M"),
ylim=c(2,5), type="b")
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MC"),
pch=2, type="b")
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MP"),
pch=3, type="b")
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MPC"),
pch=4, type="b")
legend(3,10, labels=c("M", "MC", "MP", "MPC"), pch=1:4)
?legend
legend(3,10, legend=c("M", "MC", "MP", "MPC"), pch=1:4)
legend(3,3, legend=c("M", "MC", "MP", "MPC"), pch=1:4)
legend(3,3.5, legend=c("M", "MC", "MP", "MPC"), pch=1:4)
legend(3,3.9, legend=c("M", "MC", "MP", "MPC"), pch=1:4)
legend(0,4, legend=c("M", "MC", "MP", "MPC"), pch=1:4, bty="n")
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="M"),
ylim=c(2,5), type="b", xlab="Time", ylab="Concentration")
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MC"),
pch=2, type="b")
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MP"),
pch=3, type="b")
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MPC"),
pch=4, type="b")
legend(0,4, legend=c("M", "MC", "MP", "MPC"), pch=1:4, bty="n")
metamitron$logConc <- log(metamitron$Conc)
Medie <- plyr::ddply(metamitron, c("Tesi", "Tempo"),
function(df) c(Mean=mean(df$logConc)))
plot(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="M"),
ylim=c(2,5), xlab="Time", ylab="Concentration") #,type="b")
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MC"),
pch=2)#, type="b")
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MP"),
pch=3)#, type="b")
points(Medie$Mean ~ Medie$Tempo, subset=c(Medie$Tesi=="MPC"),
pch=4)#, type="b")
abline(a=coef(model.1)[1], b=coef(model.1)[4], lty=1)
model.1 <- lm(log(Conc) ~ Tesi  / Tempo - 1, data=metamitron)
summary(model.1)
abline(a=coef(model.1)[1], b=coef(model.1)[4], lty=1)
abline(a=coef(model.1)[1], b=coef(model.1)[5], lty=1)
abline(a=coef(model.1)[1], b=coef(model.1)[5], lty=1)
abline(a=coef(model.1)[2], b=coef(model.1)[6], lty=2)
abline(a=coef(model.1)[3], b=coef(model.1)[7], lty=3)
abline(a=coef(model.1)[4], b=coef(model.1)[8], lty=4)
anova(model, model.1)
rm(list=ls())
# Chunk 1: setup
#Put at the beginning
knitr::knit_hooks$set(document = function(x){
gsub("```\n*```r*\n*", "", x)
})
#devtools::install_github("OnofriAndreaPG/aomisc")
# Chunk 2
library(aomisc)
data(metamitron)
head(metamitron)
# Chunk 3
model <- lm(log(Conc) ~ factor(Tempo)*Tesi, data=metamitron)
anova(model)
# Chunk 4
par(mfrow=c(2,2))
plot(model)
bartlett.test(log(Conc) ~ I(Tesi:factor(Tempo)), data=metamitron)
car::leveneTest(log(Conc) ~ I(Tesi:factor(Tempo)), data=metamitron)
shapiro.test(residuals(model))
# Chunk 5
model.1 <- lm(log(Conc) ~ Tesi  / Tempo - 1, data=metamitron)
summary(model.1)
anova(model, model.1)
model.2 <- lm(log(Conc) ~ Tesi + Tempo - 1, data = CO2)
model.2 <- lm(log(Conc) ~ Tesi + Tempo - 1, data = metamitron)
summary(model.2)
install.packages("/Volumes/SUNDISK/aomisc_0.22.tar.gz", repos = NULL, type = "source")
library(aomisc)
data(metamitron)
metamitron
load("~/Documents/_DBXAndrea/Dropbox/_Lavoro/MyUtilities/RPackages/aomisc/data/johnsongrass.rda")
data("johnsongrass")
ls()
library(aomisc)
data("johnsongrass")
ls()
library(aomisc)
library(aomisc)
library(aomisc)
data(johnsongrass)
data(johnsongrass)
library(aomisc)
data(johnsongrass)
View(johnsongrass)
mod1 <- lm(RizomeWeight ~ Length * Timing, data=johnsongrass)
anova(mod1)
mod2 <- lm(RizomeWeight ~ Length : Timing, data=johnsongrass)
anova(mod2)
library(aomisc)
